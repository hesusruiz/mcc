<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.19/index.global.min.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ical.js/1.5.0/ical.min.js"></script>
  <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/icalendar@6.1.19/index.global.min.js'></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');
      
      // The 3 ICS URLs
      const myCalendars = [
        { url: 'https://outlook.office365.com/owa/calendar/ec2ec47461784a6b9265ab6061f35cc1@in2.es/c3271ca0887542d699a9bbe6f5f4e8f312397657951920897755/calendar.ics', color: 'yellow' },
        { url: 'https://calendar.google.com/calendar/ical/jesus%40alastria.io/public/basic.ics', color: 'red' }
      ];

      var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,timeGridWeek,listWeek'
        },
        eventSources: myCalendars.map(cal => ({
          // We point FullCalendar to OUR proxy, not the real URL
          url: '/.netlify/functions/fetch-calendar?url=' + encodeURIComponent(cal.url),
          format: 'ics',
          color: cal.color
        }))
      });

      calendar.render();
    });
  </script>
  <style>
    body { margin: 40px 10px; padding: 0; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; font-size: 14px; }
    #calendar { max-width: 1100px; margin: 0 auto; }
  </style>
</head>
<body>
  <div id='calendar'></div>
</body>
</html>